<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pokhara University (PU) Grade Converter</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Custom styles for better visual feedback on form elements */
        .course-row:not(:last-child) {
            border-bottom: 1px solid #e5e7eb;
        }
        .grade-select {
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"></polyline></svg>');
            background-repeat: no-repeat;
            background-position: right 0.75rem center;
            background-size: 1.5em 1.5em;
            padding-right: 2.5rem;
        }
        /* Modal styles */
        .modal {
            transition: opacity 0.25s ease;
        }
        .modal-content {
            transition: transform 0.25s ease;
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-800">

    <div class="container mx-auto p-4 sm:p-6 lg:p-8 max-w-4xl">
        
        <!-- Header Section -->
        <header class="text-center mb-8">
            <h1 class="text-3xl sm:text-4xl font-bold text-gray-900">Pokhara University (PU) Grade Converter</h1>
            <p class="mt-2 text-md text-gray-600">Calculate your SGPA or CGPA based on PU's grading system.</p>
        </header>

        <!-- Main Calculator Form -->
        <main class="bg-white p-6 sm:p-8 rounded-2xl shadow-lg">
            <div id="courses-container">
                <!-- Initial Course Row -->
                <div class="course-row grid grid-cols-12 gap-4 items-center py-4">
                    <div class="col-span-12 sm:col-span-6">
                        <label for="course-name-1" class="block text-sm font-medium text-gray-700 mb-1">Course Name (Optional)</label>
                        <input type="text" id="course-name-1" class="course-name w-full p-3 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition" placeholder="e.g., Programming 101">
                    </div>
                    <div class="col-span-6 sm:col-span-2">
                        <label for="credit-hours-1" class="block text-sm font-medium text-gray-700 mb-1">Credits</label>
                        <input type="number" id="credit-hours-1" min="0.5" step="0.5" class="credit-hours w-full p-3 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition" placeholder="e.g., 3">
                    </div>
                    <div class="col-span-6 sm:col-span-3">
                        <label for="grade-1" class="block text-sm font-medium text-gray-700 mb-1">Grade</label>
                        <select id="grade-1" class="grade-select grade w-full p-3 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition bg-white">
                            <option value="">Select</option>
                            <option value="4.0">A</option>
                            <option value="3.7">A-</option>
                            <option value="3.3">B+</option>
                            <option value="3.0">B</option>
                            <option value="2.7">B-</option>
                            <option value="2.3">C+</option>
                            <option value="2.0">C</option>
                            <option value="1.7">C-</option>
                            <option value="1.3">D+</option>
                            <option value="1.0">D</option>
                            <option value="0.0">F</option>
                        </select>
                    </div>
                    <div class="col-span-12 sm:col-span-1 flex items-end justify-end pt-4 sm:pt-0">
                        <!-- The first row cannot be deleted -->
                    </div>
                </div>
            </div>

            <!-- Action Buttons -->
            <div class="mt-6 flex flex-col sm:flex-row gap-4">
                <button id="add-course" class="w-full sm:w-auto flex-grow bg-blue-600 text-white font-semibold py-3 px-6 rounded-lg shadow-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-transform transform hover:scale-105">
                    Add Another Course
                </button>
                <button id="calculate-gpa" class="w-full sm:w-auto flex-grow bg-green-600 text-white font-semibold py-3 px-6 rounded-lg shadow-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 transition-transform transform hover:scale-105">
                    Calculate GPA
                </button>
                <button id="reset-form" class="w-full sm:w-auto flex-grow bg-gray-600 text-white font-semibold py-3 px-6 rounded-lg shadow-md hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition">
                    Reset
                </button>
            </div>
        </main>
        
        <!-- Footer with do-follow link -->
        <footer class="text-center mt-8">
            <p class="text-gray-600">
                Calculator provided by <a href="https://thenepal.io" target="_blank" rel="dofollow" class="text-blue-600 hover:underline font-semibold">thenepal.io</a>
            </p>
        </footer>

    </div>

    <!-- Result Modal -->
    <div id="result-modal" class="modal fixed inset-0 bg-gray-900 bg-opacity-60 flex items-center justify-center p-4 opacity-0 pointer-events-none z-50">
        <div class="modal-content bg-white rounded-2xl shadow-2xl p-8 w-full max-w-md text-center transform scale-95">
            <h2 class="text-2xl font-bold text-gray-900 mb-4">Your Result</h2>
            <p id="result-text" class="text-5xl font-bold text-blue-600 mb-2">0.00</p>
            <p id="result-summary" class="text-gray-600 mb-6">Based on your input.</p>
            <button id="close-modal" class="w-full bg-blue-600 text-white font-semibold py-3 px-6 rounded-lg shadow-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition">
                Close
            </button>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // --- DOM Element References ---
            const coursesContainer = document.getElementById('courses-container');
            const addCourseBtn = document.getElementById('add-course');
            const calculateBtn = document.getElementById('calculate-gpa');
            const resetBtn = document.getElementById('reset-form');
            const modal = document.getElementById('result-modal');
            const closeModalBtn = document.getElementById('close-modal');
            const resultText = document.getElementById('result-text');
            const resultSummary = document.getElementById('result-summary');

            let courseCount = 1;

            // --- Grade to Point Mapping ---
            const gradePoints = {
                "A": 4.0, "A-": 3.7, "B+": 3.3, "B": 3.0, "B-": 2.7,
                "C+": 2.3, "C": 2.0, "C-": 1.7, "D+": 1.3, "D": 1.0, "F": 0.0
            };

            // --- Event Listeners ---
            addCourseBtn.addEventListener('click', addCourseRow);
            calculateBtn.addEventListener('click', calculateGPA);
            resetBtn.addEventListener('click', resetForm);
            closeModalBtn.addEventListener('click', hideModal);
            modal.addEventListener('click', function(e) {
                if (e.target === modal) {
                    hideModal();
                }
            });

            // --- Functions ---

            /**
             * Adds a new row for entering course details.
             */
            function addCourseRow() {
                courseCount++;
                const newRow = document.createElement('div');
                newRow.className = 'course-row grid grid-cols-12 gap-4 items-center py-4 animate-fade-in';
                newRow.innerHTML = `
                    <div class="col-span-12 sm:col-span-6">
                        <label for="course-name-${courseCount}" class="block text-sm font-medium text-gray-700 mb-1">Course Name (Optional)</label>
                        <input type="text" id="course-name-${courseCount}" class="course-name w-full p-3 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition" placeholder="e.g., Data Structures">
                    </div>
                    <div class="col-span-6 sm:col-span-2">
                        <label for="credit-hours-${courseCount}" class="block text-sm font-medium text-gray-700 mb-1">Credits</label>
                        <input type="number" id="credit-hours-${courseCount}" min="0.5" step="0.5" class="credit-hours w-full p-3 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition" placeholder="e.g., 3">
                    </div>
                    <div class="col-span-6 sm:col-span-3">
                        <label for="grade-${courseCount}" class="block text-sm font-medium text-gray-700 mb-1">Grade</label>
                        <select id="grade-${courseCount}" class="grade-select grade w-full p-3 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition bg-white">
                            <option value="">Select</option>
                            <option value="4.0">A</option>
                            <option value="3.7">A-</option>
                            <option value="3.3">B+</option>
                            <option value="3.0">B</option>
                            <option value="2.7">B-</option>
                            <option value="2.3">C+</option>
                            <option value="2.0">C</option>
                            <option value="1.7">C-</option>
                            <option value="1.3">D+</option>
                            <option value="1.0">D</option>
                            <option value="0.0">F</option>
                        </select>
                    </div>
                    <div class="col-span-12 sm:col-span-1 flex items-end justify-end pt-4 sm:pt-0">
                        <button class="remove-course bg-red-500 text-white rounded-full p-2 shadow-md hover:bg-red-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 transition-transform transform hover:scale-110">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                                <path fill-rule="evenodd" d="M5 10a1 1 0 011-1h8a1 1 0 110 2H6a1 1 0 01-1-1z" clip-rule="evenodd" />
                            </svg>
                        </button>
                    </div>
                `;
                coursesContainer.appendChild(newRow);

                // Add event listener to the new remove button
                newRow.querySelector('.remove-course').addEventListener('click', function() {
                    newRow.remove();
                });
            }

            /**
             * Calculates the GPA based on the input fields.
             */
            function calculateGPA() {
                let totalPoints = 0;
                let totalCredits = 0;
                let isValid = true;

                const courseRows = document.querySelectorAll('.course-row');
                
                // Clear previous errors
                courseRows.forEach(row => {
                    row.querySelector('.credit-hours').classList.remove('border-red-500');
                    row.querySelector('.grade').classList.remove('border-red-500');
                });

                courseRows.forEach(row => {
                    const creditInput = row.querySelector('.credit-hours');
                    const gradeSelect = row.querySelector('.grade');

                    const credits = parseFloat(creditInput.value);
                    const gradePoint = parseFloat(gradeSelect.value);
                    
                    // Validation
                    if (isNaN(credits) || credits <= 0) {
                        creditInput.classList.add('border-red-500', 'ring-red-500');
                        isValid = false;
                    }
                    if (isNaN(gradePoint)) {
                        gradeSelect.classList.add('border-red-500', 'ring-red-500');
                        isValid = false;
                    }

                    if (!isNaN(credits) && !isNaN(gradePoint)) {
                        totalPoints += credits * gradePoint;
                        totalCredits += credits;
                    }
                });

                if (!isValid) {
                    showModal("Error", "Please fill in all required credit and grade fields correctly.", true);
                    return;
                }

                if (totalCredits === 0) {
                    showModal("Error", "Total credit hours cannot be zero. Please enter your course details.", true);
                    return;
                }

                const gpa = totalPoints / totalCredits;
                showModal(gpa.toFixed(2), `Based on ${totalCredits} total credit hours.`);
            }

            /**
             * Resets the entire form to its initial state.
             */
            function resetForm() {
                coursesContainer.innerHTML = '';
                courseCount = 0;
                addCourseRow(); // Add back the first row
            }

            /**
             * Shows the result modal with a message.
             * @param {string} gpa - The calculated GPA or an error title.
             * @param {string} summary - A summary message.
             * @param {boolean} isError - Optional flag for error styling.
             */
            function showModal(gpa, summary, isError = false) {
                if (isError) {
                    resultText.classList.remove('text-blue-600');
                    resultText.classList.add('text-red-600');
                    resultText.textContent = gpa; // gpa is the error title here
                    resultSummary.textContent = summary;
                } else {
                    resultText.classList.remove('text-red-600');
                    resultText.classList.add('text-blue-600');
                    resultText.textContent = gpa;
                    resultSummary.textContent = summary;
                }
                modal.classList.remove('opacity-0', 'pointer-events-none');
                modal.querySelector('.modal-content').classList.remove('scale-95');
                modal.querySelector('.modal-content').classList.add('scale-100');
            }

            /**
             * Hides the result modal.
             */
            function hideModal() {
                modal.classList.add('opacity-0');
                modal.querySelector('.modal-content').classList.add('scale-95');
                modal.querySelector('.modal-content').classList.remove('scale-100');
                setTimeout(() => {
                    modal.classList.add('pointer-events-none');
                }, 250); // Match transition duration
            }

            // Add a simple fade-in animation for course rows
            const styleSheet = document.createElement("style");
            styleSheet.type = "text/css";
            styleSheet.innerText = `
                @keyframes fadeIn {
                    from { opacity: 0; transform: translateY(-10px); }
                    to { opacity: 1; transform: translateY(0); }
                }
                .animate-fade-in {
                    animation: fadeIn 0.5s ease-out forwards;
                }
            `;
            document.head.appendChild(styleSheet);
        });
    </script>

</body>
</html>
